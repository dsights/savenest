# SaveNest AI Context & Reference Sheet

## 1. Project Architecture
*   **Frontend:** Flutter Web (Release mode). Deployed to `public_html/`.
*   **Backend:** FastAPI (Python 3.9). Deployed to `~/savenest_backend/` and served via Passenger WSGI.
*   **Base URL:** `https://savenest.au`
*   **API URL:** `https://savenest.au/api/` (proxied to the FastAPI app).

## 2. Infrastructure Details
*   **Host IP:** `198.38.93.19`
*   **SSH/FTP User:** `tripxen1`
*   **Python App Root:** `/home/tripxen1/savenest_backend`
*   **VirtualEnv Path:** `/home/tripxen1/virtualenv/savenest_backend/3.9`
*   **Entry Point:** `passenger_wsgi.py` -> `application`

## 3. Deployment Workflow (GitHub Actions)
The deployment is fully automated via `.github/workflows/deploy.yml`:
1.  **Build:** Compiles Flutter Web in release mode.
2.  **Web Deploy:** Uses FTP to sync `build/web/` with `public_html/`.
3.  **Script Upload:** Uses SCP to move `deploy_backend.sh` to `~/`.
4.  **Backend Deploy:** Uses SSH to run `~/deploy_backend.sh`.

## 4. Critical Dependencies & Configs
*   **Backend Proxy:** `backend/main.py` uses `a2wsgi` to translate ASGI (FastAPI) to WSGI (Passenger).
*   **Diagnostic Mode:** `passenger_wsgi.py` contains a diagnostic catch-block. If modules are missing, visit the API URL in a browser to see the report.
*   **CORS:** Regulated by `ALLOWED_ORIGINS` env var. Defaults to `*` if not set, but production should be `https://savenest.au,https://www.savenest.au`.

## 5. Required Secrets (GitHub Settings)
*   `FTP_USERNAME`: `tripxen1`
*   `FTP_PASSWORD`: (cPanel Password)
*   `SSH_USERNAME`: `tripxen1`
*   `SSH_PASSWORD`: (cPanel Password)
*   `HUBSPOT_TOKEN`: HubSpot Private App Access Token.

## 6. Maintenance Commands (Remote SSH)
*   **Restart Backend:** `touch ~/savenest_backend/tmp/restart.txt`
*   **Check Logs:** `tail -f ~/savenest_backend/stderr.log`
*   **Manual Venv Activation:** `source ~/virtualenv/savenest_backend/3.9/bin/activate`

## 7. Known Quirks
*   **python-multipart:** Must be installed as `python-multipart` but imported as `import multipart`.
*   **cPanel Python App:** If the app fails to start after a code change, ensure the "Application Entry point" in cPanel UI is set to `application`.
